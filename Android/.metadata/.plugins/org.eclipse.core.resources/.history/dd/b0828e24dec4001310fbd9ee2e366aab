package com.jellydiamonds.android.metier;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.util.Date;

public class JellyUser implements Serializable {

	/**
	 * 
	 */
	private static final long serialVersionUID = 3998293232567716497L;
	
	private String mUserID = null;
	private String mDisplayName = null;
	private String mFirstName = null;
	private String mLastName = null;
	private String mEmail = null;
	private String mPhone = null;
	private String mAddress = null;
	private String mCity = null;
	private String mCountry = null;
	
	private Date   			mSignupDate = null;
	private JellyLicence 	mLicence = null;
	private JellyCollection mCollection = null;

	
	public JellyUser()
	{
		// User creation date
		this.mSignupDate = new Date( System.currentTimeMillis() );
		this.mCollection = new JellyCollection( this.mUserID );
	}
	
	public JellyCollection getCollection()
	{
		return this.mCollection;
	}
	
	public void setCollection( JellyCollection collection )
	{
		this.mCollection = collection;
	}
	
	public JellyLicence getLicence() {
		return mLicence;
	}

	public void setLicence(JellyLicence mLicence) {
		this.mLicence = mLicence;
	}

	public String getUserID() {
		return mUserID;
	}

	public void setUserID(String mUserID) {
		this.mUserID = mUserID;
	}


	public String getDisplayName() {
		return mDisplayName;
	}


	public void setDisplayName(String mDisplayName) {
		this.mDisplayName = mDisplayName;
	}


	public String getFirstName() {
		return mFirstName;
	}


	public void setFirstName(String mFirstName) {
		this.mFirstName = mFirstName;
	}


	public String getLastName() {
		return mLastName;
	}


	public void setLastName(String mLastName) {
		this.mLastName = mLastName;
	}


	public String getEmail() {
		return mEmail;
	}


	public void setEmail(String mEmail) {
		this.mEmail = mEmail;
	}


	public String getPhone() {
		return mPhone;
	}


	public void setPhone(String mPhone) {
		this.mPhone = mPhone;
	}


	public String getAddress() {
		return mAddress;
	}


	public void setAddress(String mAddress) {
		this.mAddress = mAddress;
	}


	public String getCity() {
		return mCity;
	}


	public void setCity(String mCity) {
		this.mCity = mCity;
	}


	public String getCountry() {
		return mCountry;
	}


	public void setCountry(String mCountry) {
		this.mCountry = mCountry;
	}


	public Date getSignupDate() {
		return mSignupDate;
	}


	public void setSignupDate(Date mSignupDate) {
		this.mSignupDate = mSignupDate;
	}
	
	public static boolean saveJellyUserContext( String nameFile, String directory, JellyUser user )
	{
		File l_saveDir = null;
		File l_saveFile = null;
		ObjectOutputStream l_outStream = null;
		
		if( 	( nameFile == null ) ||
				( directory == null ) || 
				( user == null ) )
			return false;
		
		l_saveDir = new File( directory );
		
		if(		( !l_saveDir.isDirectory() ) || 
				( !l_saveDir.canWrite() ) )
			return false;
		
		try {
			l_saveFile = File.createTempFile( nameFile , ".jelly", l_saveDir );
			
			l_outStream = new ObjectOutputStream( new FileOutputStream( l_saveFile ) );
			l_outStream.writeObject( user );
			
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return false;
		}
		finally
		{
			if( l_outStream !=  null)
			{
				try {
					l_outStream.close();
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
					return false;
				}
			}
		}
	
		
		return true;
	}
	
	public static JellyUser recoverJellyUserContext( String nameFile, String directory )
	{
		File l_saveDir = null;
		File l_saveFile = null;
		ObjectInputStream l_inStream = null;
		
		if( 	( nameFile == null ) ||
				( directory == null ) )
			return null;
		
		l_saveDir = new File( directory );
		
		if( ! l_saveDir.isDirectory() )
			return null;
		
		l_saveFile = new File( l_saveDir, nameFile );
		
		if( ( !l_saveFile.isFile() ) ||
			( !l_saveFile.canRead() ) )
			return null;
		
		try {
			l_inStream = new ObjectInputStream( new FileInputStream( l_saveFile ) );
			
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return null;
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			return null;
		}
		finally
		{
			if( l_inStream !=  null)
			{
				try {
					l_inStream.close();
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
					return null;
				}
			}
		}
	}
}
